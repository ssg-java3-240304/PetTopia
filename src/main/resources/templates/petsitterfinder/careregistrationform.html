<!DOCTYPE html>
<html layout:decorate="~{layout/default}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>펫시터 찾기 페이지 입니다</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7f6; /* 부드러운 배경 색상 */
        }

        .page-body {
            width: 60%;
            margin: 20px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333333; /* 다크 그레이 텍스트 */
        }

        input[type="text"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #dddddd;
            border-radius: 6px;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
            background-color: #f9f9f9; /* 밝은 배경 */
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus,
        textarea:focus {
            border-color: #7cb342; /* 포커스 시 그린 색상 */
            outline: none;
        }

        input[type="radio"] {
            margin-right: 8px;
        }

        .submit-btn {
            background-color: #7cb342;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: block;
            width: 100%;
            font-size: 16px;
            margin-top: 20px;
        }

        .submit-btn:hover {
            background-color: #689f38; /* 호버 시 더 어두운 그린 */
        }

        img {
            display: block;
            margin-top: 10px;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .form-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap; /* 화면이 작을 때 줄바꿈 */
        }

        .left-column, .right-column {
            width: 48%;
            min-width: 300px; /* 최소 너비 설정 */
            box-sizing: border-box;
        }

        #map {
            height: 300px;
            width: 100%;
            margin-top: 15px;
            border-radius: 6px;
        }

        #showImage {
            position: relative;
            overflow: hidden;
            height: 200px; /* 적절한 높이 설정 */
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #e9e9e9;
            border: 1px solid #ccc;
            margin-top: 10px;
            border-radius: 6px;
        }

        #showImage img {
            transition: transform 0.3s ease;
            max-width: 100%;
            max-height: 100%;
        }

        .prev, .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 10px;
            margin-top: -22px;
            color: white;
            font-weight: bold;
            font-size: 18px;
            transition: 0.6s ease;
            border-radius: 3px;
            user-select: none;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }

        .prev {
            left: 0;
            border-radius: 3px 0 0 3px;
        }

        /* 라디오 버튼 그룹 스타일링 */
        .radio-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

    </style>

</head>
<!-- 8/ 07 해야할일 - 태준 -
    input 태그로 입력된 값 controller에서 받아 DTO로 넘기기
    태그별로 매핑 다 해놓기
    option 태그 보이는건 pet.name으로 해놓고 실제로 입력했을 때 pet.id 로 받아오도록 하도록 하기

    -  모르겠는것
    Pet의 정보를 어디에 무엇으로 가져와야할지 아직 감이 안잡힌다.
    petservice 호출해서 findAll 한다음 그걸 ResponseDto<List> 에 담아서 화면단에 보여주면되나???
    서비스에서 받아온 값을 다시 controller로 리턴시켜서 다시 값을 받아오는건지 확인!
-->

<!--
    - HTML에서 폼 데이터를 서버로 전송할 때 입력 값을 식별하기 위해 사용되는 속성은 'name'

    -name 속성
    목적: 폼데이터 서버로 전송될때 데이터 식별하는 데 사용
    ex) input type = text, name= username 에서 입력한 텍스트는 username 이라는 이름으로 서버로 전송

    - id 속성
    목적 : HTML 문서 내에서 요소를 유일하게 식별하기위해 사용. 이속성은 JavaScript나 CSS에서 특정 요소를 선택, 스타일 적용
    ex) document.getElementById('username')
    * id는 문서 내에서 고유해야 하며, 하나의 요소에만 할당됨. 스타일 적용이나 스크립트 조작을 위해 사용된다.*
-->
<body>
<div class="page-body" layout:fragment="main">
    <section class="hero-wrap hero-wrap-2" data-stellar-background-ratio="0.5"
             style="background-image: url('/images/KakaoTalk_20240527_201110282.jpg'); height: 200px; border-radius: 8px;"></section>
    <form method="post" name="careRegistration">
        <div class="form-container">
            <div class="left-column">
                <div class="form-group">
                    <!--                펫 이름을 노출시키고, 폼 제출 시 펫 아이디를 전송함-->
                    <!--                    petId를 서버에서 requestParam을 통해 전달받을 수 있다. -->
                    <!--                    선택하기전 기본값을 돌보실 펫을 선택해 주세요로 설정 disabled selected-->

                    <!--                    8/8 오전 1:32 그럼 petid를 선택하자마자 이벤트를 발생시켜야함
                                                발생한 이벤트로 petId값이 전달되고 그 값을 서버에서 받아서
                                                petId에 해당하는 pet의 정보가 돌아록해서 비동기처리로 폼에 값들 전부 입력 되도록 해야할 것 같다. .. 현재의 계획.. 될진 모른다
                        -->
                    <label>펫 선택:</label>
                    <select id="petSelect" name="petId">
                        <option disabled selected value="">돌보실 펫을 선택해 주세요.</option>
                        <option th:each="pet : ${pets}" th:text="${pet.name}" th:value="${pet.petId}"></option>
                    </select>
                </div>
                <!--            8/8 일 오전 1:51 돌볼 펫을 선택하면 event를 발생시켜 petId를 출력시켜주는 코드
                                실제로 console 창에 option 태그에서 펫 이름 선택하면 그에 맞는 petId가 출력되는 것을 확인했음
                                출력된 id 값으로 ajax를 통해 각 폼에 맞게 뿌려주는걸 어떻게 하는지 고민해봐야할듯

                -->
                <script>
                    /**
                     *  08/08 3시20분 400 bad request 발생
                     *  400 오류?
                     *   The 400 (Bad Request) status code indicates that the server cannot or
                     *    will not process the request because the received syntax is invalid,
                     *    nonsensical, or exceeds some limitation on what the server is willing
                     *    to process.
                     *    -> 문법오류라는 듯?
                     */
                    document.getElementById('petSelect').addEventListener('change', function () {
                        var petId = this.value;
                        console.log("선택된 펫 ID : ", petId)

                        // 비동기 처리로 pet의정보 가져오는 코드 8/8일 박태준
                        //
                        $.ajax({
                            url: '[[@{/petsitterfinder/request-pet-info}]]',
                            method: 'get',
                            dataType: 'json',
                            data: {petId: petId},
                            success(data) {
                                $('#petName').val(data.name)
                                $('#petAge').val(data.age)
                                $('#petGender').val(data.petGender)
                                $('#petBirth').val(data.birth)
                                $('#petSociability').val(data.socialization)
                                $('#petSize').val(data.size)
                                $('#petVaccination').val(data.vaccinationType)
                                $('#petParasitePrevention').val(data.parasitePrevention)
                                $('#petBreed').val(data.breed)
                                $('#isMissing').val(data.status)
                                $('#isNeutered').val(data.neutered)
                            }
                        })

                    })

                    // 8/8 박태준 비동기처리로 json 데이터 타입 받아오는 코드
                </script>
                <script>

                </script>
                <!-- 이미지 업로드를 위한 폼 필드 -->
                <div class="form-group">
                    <div>
                        <input onchange="readURL(this)" type="file">
                        <img alt="미리보기 이미지" id="preview"/>
                    </div>
                </div>
                <!--            08/07 태준
                                option 태그에서 강아지 입력했을 때 아래 input 태그들을 ajax로 비동기 처리식으로 처리해야하는데 어떻게 할지 생각해보자

                                - json
                                데이터를 저장하거나 전송할 때 사용되는 텍스트 기반의 경량의 데이터 교환 방식
                                json은 읽기 쉽고, 스기 쉬움, 기계가 파싱하기 쉬운 테스트 기반임

                                - ajax
                                javascript를 사용하여 비동기적으로 데이터를 서버와 교환
                                ajax 사용하면 새로고침하지 않아도 부분적인 페이지 업데이트가 가능함

                -->
                <div class="form-group">
                    <label for="petName">이름:</label>
                    <input id="petName" name="petName" type="text">
                </div>

                <div class="form-group">
                    <label for="petGender">성별:</label>
                    <input id="petGender" name="petGender" type="text">
                </div>

                <div class="form-group">
                    <label for="petBreed">견종:</label>
                    <input id="petBreed" name="petBreed" type="text">
                </div>
                <div class="form-group">
                    <label for="petBirth">출생일:</label>
                    <input id="petBirth" name="petBirth" type="text">
                </div>
                <div class="form-group">
                    <label for="petSize">사이즈:</label>
                    <input id="petSize" name="petSize" type="text">
                </div>
                <div class="form-group">
                    <label for="petSociability">사회성:</label>
                    <input id="petSociability" name="petSociability" type="text">
                </div>
                <div class="form-group">
                        <label for = "petVaccination">예방접종:</label>
                        <input id="petVaccination" name="petVaccination" type="text" >
                </div>
                <div class="form-group">
                    <label for = "petParasitePrevention">기생충 예방:</label>
                    <input id="petParasitePrevention" name="petParasitePrevention" type="text" >
                </div>
                <div class="form-group">
                    <label>실종 여부:</label>
                    <input id="isMissing" name="isMissing" type="text" >
                </div>
                <div class="form-group">
                    <label>중성화 여부:</label>
                    <input id="isNeutered" name="isNeutered" type="text" >
                </div>
            </div>

                <!-- 08/07 와요랑 비교해서 돌봄 종류가 어떤 것이 있는지 확인하고 매칭시키기-->
            <div class="right-column">
                <div class="form-group">
                    <label for="startDate">시작 날짜:</label>
                    <input id="startDate" name="startDate" type="date">
                </div>
                <div class="form-group">
                    <label for="endDate">종료 날짜:</label>
                    <input id="endDate" name="endDate" type="date">
                </div>

                <script>
                    /**
                     * 08/09 박태준 시작날짜, 종료 날짜 받아오는 javascript
                     */
                     document.getElementById('startDate').addEventListener('change', function(){
                            const startDate = this.value
                         console.log(startDate);
                     })

                    document.getElementById('endDate').addEventListener('change', function(){
                        const endDate = this.value
                        console.log(endDate);
                    })


                </script>
                <div class="form-group">
                    <label for="address">주소 입력(*동까지만 입력해주세요*): </label>
                    <input id="address" name="address" placeholder="주소를 입력하세요" type="text">
                </div>
                <div class="form-group">
                    <label>돌봄유형:</label>
                    <!--                 radio 는 name 다르게하면 다중선택 가능 -->
                    <div class="radio-group">
                        <input id="visitCare" name="visitCare" type="radio" value="방문돌봄" onclick="toggleRadio(this)">
                        <label for="visitCare">방문돌봄</label>

                        <input id="walkCare" name="walkCare" type="radio" value="산책돌봄" onclick="toggleRadio(this)">
                        <label for="walkCare">산책</label>

                        <input id="leavingCare" name="leavingCare" type="radio" value="맡김돌봄" onclick="toggleRadio(this)">
                        <label for="leavingCare">맡김 돌봄</label>
                    </div>

                    <script>
                        <!--  08/09 박태준 radio 취소하는 코드 -->
                        let lastChecked = null;
                        function toggleRadio(radio) {
                            if (lastChecked === radio) {
                                radio.checked = false;
                                lastChecked = null;
                            } else {
                                lastChecked = radio;
                            }

                            document.getElementById('visitCare').addEventListener('change', function(){
                                const visitCare = this.value
                                console.log(visitCare);
                            })

                            document.getElementById('walkCare').addEventListener('change', function(){
                                const walkCare = this.value
                                console.log(walkCare);
                            })
                            document.getElementById('leavingCare').addEventListener('change', function(){
                                const leavingCare = this.value
                                console.log(leavingCare);
                            })
                        }
                    </script>
                </div>
                <!--            radio 태그의 value 속성은 해당 라디오 버튼이 선택됐을 때 제출되는 값이다 -->
            </div>
            <button class="submit-btn" type="submit">등록하기</button>
<!--            8/9 박태준
            Submit 하면 일단 CareRegistration DB에 값들 전부 등록 되도록 해야함
            아직 감이안온다.. DTO로 받아서 Entity 변환 후에 Data insert 되도록 해야할듯
-->
        </div>
    </form>

    <script>
        // 이미지 읽어오는 자바 스크립트 코드
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('preview').src = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            } else {
                document.getElementById('preview').src = "";
            }
        }

        /**
         * - JavaScript document.querySelector를 이용해서 라디오박스의 선택 된 값을 가져올 수 있다.
         *ex) doument.querySelector('input[type=radio][name={라디오버튼의 name}]:checked').value;
         *
         * - JQuery를 이용해서 라디오 박스의 선택된 값을 가져오는 코드
         * $("input:radio[name='{라디오버튼  Name}']:checked").val();
         *
         */
    </script>
</div>

<!-- script 파일 무조건 fragment layout 내부에 있어야 하네 -->

</body>

</html>
