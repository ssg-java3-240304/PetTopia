<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
  <title>병원리뷰</title>
  <style>
    /* 팝업 창의 스타일 */
    #uploadPopup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 600px;
      height: auto;
      max-height: 80vh;
      padding: 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      overflow-y: auto;
      z-index: 1000;
    }

    /* 버튼 스타일 */
    button {
      background-color: #00bd56;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background-color: #00a14e;
    }

    /* 폼 스타일 */
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    input[type="file"] {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
    }

    /* 추가 콘텐츠 영역 스타일 */
    .additional-content {
      margin-top: 20px;
    }

    /* 강조된 텍스트 스타일 */
    .highlight {
      font-size: 1.5em;
      font-weight: bold;
    }

    /* 주의사항 목록 스타일 */
    .warning-list {
      list-style-type: none;
      padding-left: 0;
    }

    .warning-list li {
      margin-bottom: 5px;
    }

    .close-button {
      margin-top: 20px;
      align-self: flex-end;
    }
  </style>
</head>
<body>

<div layout:fragment="main" class="page-body">
  <section class="hero-wrap hero-wrap-2" style="background-image: url('/images/bg_2.jpg');"
           data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
      <div class="row no-gutters slider-text align-items-end">
        <div class="col-md-9 ftco-animate pb-5">
          <p class="breadcrumbs mb-2"><span class="mr-2"><a href="index.html">Home <i
                  class="ion-ios-arrow-forward"></i></a></span> <span class="mr-2"><a href="blog.html">병원 • 약국 • 미용실
              <i class="ion-ios-arrow-forward"></i></a></span> <span>병원 리뷰 <i class="ion-ios-arrow-forward"></i></span></p>
          <h1 class="mb-0 bread">리뷰</h1>
        </div>
      </div>
    </div>
  </section>

  <section class="ftco-section ftco-degree-bg">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 ftco-animate">
          <p>
            <img src="images/image_1.jpg" alt="" class="img-fluid">
          </p>
          <h2 class="mb-3">태준태준 동물병원</h2>
          <p>영업 시간 :</p>
          <p>병원 소개 :</p>
          <p>해당 병원 링크 ~~ </p>

          <h2 class="mb-3 mt-5">#2. 적어주세요</h2>

          <div class="about-author d-flex p-4 bg-light">
            <div class="bio mr-5">
              <img src="images/person_1.jpg" alt="Image placeholder" class="img-fluid mb-4">
            </div>
            <div class="desc">
              <h3>병원관련해서 추가내용</h3>
              <p>여기에 적어주세용</p>
            </div>
          </div>

          <div id="verificationSection" class="pt-5 mt-5">
            <p>리뷰를 작성하시려면 영수증 인증이 필요합니다.</p>
            <button id="verifyButton" style="background-color: #00bd56; color: white; padding: 10px; border: none; cursor: pointer;">
              인증하러 가기
            </button>
          </div>

          <!-- 파일 업로드 폼 (팝업) -->
          <div id="uploadPopup">
            <h2>영수증 인증</h2>
            <form name="fileUploadFrm" method="post">
              <label for="type">문서 유형 선택:</label>
              <select name="type">
                <option value="general">영수증</option>
              </select>
              <input type="file" name="file" accept="image/*" required/>
              <button type="submit">인증하기</button>
            </form>

            <!-- 추가 콘텐츠 영역 -->
            <div class="additional-content">
              <span class="highlight">영수증 인증시 주의사항</span>
              <pre>
영수증 인식은 OCR 기술을 통해 읽은 문자와 숫자를 바로 보여주고 있습니다.
이 과정에서 다양한 문제로 영수증 인식이 실패될 수 있습니다.
    </pre>
              <ul class="warning-list">
                <li><strong>올바른 영수증 촬영 방법</strong></li>
                <li>- 영수증을 펼친 후, 영수증 전체가 잘 나오도록 정면에서 촬영</li>
                <li>- 배경에 다른 물체나 글씨가 없도록 촬영</li>
                <li>- 필수 정보(업체명, 전화번호, 사업자등록번호, 결제 일시, 승인번호 등)가 잘 나오도록 촬영</li>

                <li><strong>올바르지 못한 영수증 촬영 예시</strong></li>
                <li>- 영수증의 일부만 나오는 경우</li>
                <li>- 복잡한 배경과 함께 찍은 경우</li>
                <li>- 손가락으로 영수증을 가린 경우</li>
                <li>- 기울어진 영수증 사진</li>
                <li>- 찢어지거나 구겨진 영수증</li>
                <li>- 영수증 여러 장을 겹쳐서 찍은 경우</li>
                <li>- 모니터에 있는 영수증을 촬영한 경우</li>
                <li>- 휴대폰에 있는 영수증을 촬영한 경우</li>
              </ul>
            </div>
            <button type="button" class="close-button" onclick="closePopup()">닫기</button>
          </div>

          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
                  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
                  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
          <script>
            // "인증하러 가기" 버튼 클릭 시 파일 업로드 팝업 열기
            document.getElementById('verifyButton').onclick = function() {
              document.getElementById('uploadPopup').style.display = 'block';
            };

            // 팝업 닫기
            function closePopup() {
              document.getElementById('uploadPopup').style.display = 'none';
            }

            document.fileUploadFrm.onsubmit = (e) => {
              e.preventDefault();

              // multipart/form-data 비동기 요청
              const frmData = new FormData(e.target);
              console.log('type = ', frmData.get('type'));
              console.log('file = ', frmData.get('file'));

              $.ajax({
                url: `[[@{/ocrUpload}]]`,
                method: 'post',
                data: frmData,
                contentType: false, // multipart/form-data 설정
                processData: false, // multipart/form-data 설정
                success(response) {
                  console.log(response);
                  const {message, data} = response;
                  alert(message);
                  const _data = JSON.parse(data);
                  console.log(_data);

                  // 업로드 성공 시 리뷰 작성 폼 보이기
                  document.getElementById('reviewForm').style.display = 'block';
                  closePopup(); // 팝업 닫기
                },
                error: console.log,
                complete() {
                  e.target.reset(); // 폼 초기화
                }
              })
            };
          </script>

          <!-- 리뷰 부분 -->
          <div class="pt-5 mt-5">
            <h3 class="mb-5">3개 리뷰</h3>
            <ul class="comment-list">
              <li class="comment">
                <div class="vcard bio">
                  <img src="images/person_1.jpg" alt="Image placeholder">
                </div>
                <div class="comment-body">
                  <h3>홍지디</h3>
                  <div class="meta">4월 7일, 2024</div>
                  <p>음.. 나쁘지 않네요:)</p>
                </div>
              </li>

              <li class="comment">
                <div class="vcard bio">
                  <img src="images/person_1.jpg" alt="Image placeholder">
                </div>
                <div class="comment-body">
                  <h3>태주운</h3>
                  <div class="meta">5월 10일, 2024 </div>
                  <p>괜찮게 사용했습니다~~ 허허</p>
                </div>
              </li>

              <li class="comment">
                <div class="vcard bio">
                  <img src="images/person_1.jpg" alt="Image placeholder">
                </div>
                <div class="comment-body">
                  <h3>갓창욱</h3>
                  <div class="meta">6월 6일, 2023</div>
                  <p>역시 갓갓갓!</p>
                </div>
              </li>
            </ul>
            <!-- END comment-list -->

            <!-- 리뷰 쓰기 -->
            <div id="reviewForm" class="comment-form-wrap pt-5" style="display:none;">
              <h3 class="mb-5">🖋️ 리뷰 쓰기</h3>
              <form action="#" class="p-5 bg-light">
                <div class="form-group">
                  <label for="name">Name *</label>
                  <input type="text" class="form-control" id="name">
                </div>
                <div class="form-group">
                  <label for="message">Message</label>
                  <textarea name="" id="message" cols="30" rows="10" class="form-control"></textarea>
                </div>
                <div class="form-group">
                  <input type="submit" value="Post Comment" class="btn py-3 px-4 btn-primary">
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- 사이드 부분(광고용) -->
        <div class="col-lg-4 sidebar pl-lg-5 ftco-animate">
          <div class="sidebar-box">
            <form action="#" class="search-form">
              <div class="form-group">
                <span class="fa fa-search"></span>
                <input type="text" class="form-control" placeholder="Type a keyword and hit enter">
              </div>
            </form>
          </div>

          <div class="sidebar-box ftco-animate">
            <h3>근처 비슷한 업체</h3>
            <div class="block-21 mb-4 d-flex">
              <a class="blog-img mr-4" style="background-image: url(/images/image_1.jpg);"></a>
              <div class="text">
                <h3 class="heading"><a href="#">희망 동물병원</a></h3>
                <div class="meta">
                  <div><a href="#"><span class="icon-calendar"></span> April 7, 2020</a></div>
                  <div><a href="#"><span class="icon-person"></span> Admin</a></div>
                  <div><a href="#"><span class="icon-chat"></span> 19</a></div>
                </div>
              </div>
            </div>
            <div class="block-21 mb-4 d-flex">
              <a class="blog-img mr-4" style="background-image: url(/images/image_2.jpg);"></a>
              <div class="text">
                <h3 class="heading"><a href="#">머지가머지 동물병원</a></h3>
                <div class="meta">
                  <div><a href="#"><span class="icon-calendar"></span> April 7, 2020</a></div>
                  <div><a href="#"><span class="icon-person"></span> Admin</a></div>
                  <div><a href="#"><span class="icon-chat"></span> 19</a></div>
                </div>
              </div>
            </div>
            <div class="block-21 mb-4 d-flex">
              <a class="blog-img mr-4" style="background-image: url(/images/image_3.jpg);"></a>
              <div class="text">
                <h3 class="heading"><a href="#">에이좍스 병원</a></h3>
                <div class="meta">
                  <div><a href="#"><span class="icon-calendar"></span> April 7, 2020</a></div>
                  <div><a href="#"><span class="icon-person"></span> Admin</a></div>
                  <div><a href="#"><span class="icon-chat"></span> 19</a></div>
                </div>
              </div>
            </div>
          </div>

          <div class="sidebar-box ftco-animate">
            <h3>진료 가능</h3>
            <div class="tagcloud">
              <a href="#" class="tag-cloud-link">cat</a>
              <a href="#" class="tag-cloud-link">dog</a>
              <a href="#" class="tag-cloud-link">pet</a>
              <a href="#" class="tag-cloud-link">bird</a>
              <a href="#" class="tag-cloud-link">husky</a>
              <a href="#" class="tag-cloud-link">bulldog</a>
              <a href="#" class="tag-cloud-link">food</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section> <!-- .section -->
</div>

<!-- loader -->
<div id="ftco-loader" class="show fullscreen">
  <svg class="circular" width="48px" height="48px">
    <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/>
    <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
            stroke="#F96D00"/>
  </svg>
</div>

</body>
</html>
