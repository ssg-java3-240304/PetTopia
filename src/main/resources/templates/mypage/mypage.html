<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout/default}">
<head>
    <title>MyPage</title>
    <style>
        tbody {
            height: 200px; /* Set the desired height for scrolling */
            overflow-y: auto; /* Enable vertical scrolling */
        }

        table {

            text-align: center;
        }

    </style>
    <style>
        /* readonly 속성을 가진 입력 필드의 스타일 */
        input[readonly] {
            background-color: #f0f0f0; /* 회색 배경 */
            color: #888888; /* 회색 텍스트 */
            border: 1px solid #cccccc; /* 회색 테두리 */
        }

        /* 편집 가능한 입력 필드의 스타일 */
        input:not([readonly]) {
            background-color: #ffffff; /* 흰색 배경 */
            color: #000000; /* 검은색 텍스트 */
            border: 1px solid #000000; /* 검은색 테두리 */
        }
    </style>
    <script>
        function showSection(sectionId) {
            // 모든 섹션을 숨기기
            document.getElementById('editProfileSection').style.display = 'none';
            document.getElementById('petProfileSection').style.display = 'none';
            document.getElementById('petsitterRegist').style.display = 'none';
            document.getElementById('Iwilltakecareofyou').style.display = 'none';
            document.getElementById('Pleasetakecare').style.display = 'none';
            // document.getElementById('petSitterSection').style.display = 'none';
            document.getElementById('payStatusSection').style.display = 'none';

            // 선택된 섹션만 보이기
            var section = document.getElementById(sectionId);
            section.style.display = 'block';

            // 선택된 섹션으로 스크롤 이동
            section.scrollIntoView({behavior: 'smooth'});
        }
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <style>
        .nav-tabs {
            display: flex;
            flex-wrap: nowrap;
            justify-content: center;
            border-bottom: none; /* 아래쪽 경계선을 없앱니다 */
        }

        .nav-link {
            white-space: nowrap; /* 텍스트가 줄바꿈되지 않도록 */
            padding: 15px 30px;  /* 버튼 크기를 키워서 가독성 향상 */
            font-size: 1.2rem;   /* 글자 크기 조정 */
            border-radius: 5px;  /* 버튼 모서리를 둥글게 */
        }
        .my-nav {
            margin-bottom: 60px; /* nav와 h3 사이의 간격 조정 */
        }

        .my-section-title {
            margin-top: 60px;  /* h3과 위 요소들 사이의 간격 조정 */
        }
    </style>
</head>
<body>
<div layout:fragment="main" class="page-body">

    <section class="hero-wrap hero-wrap-2" style="background-image: url('/images/bg_2.jpg');"
             data-stellar-background-ratio="0.5">
        <div class="overlay"></div>
        <div class="container">
            <div class="row no-gutters slider-text align-items-end">
                <div class="col-md-9 ftco-animate pb-5">
                    <p class="breadcrumbs mb-2"><span class="mr-2"><a href="../index.html">Home <i
                            class="ion-ios-arrow-forward"></i></a></span> <span>MyPage <i
                            class="ion-ios-arrow-forward"></i></span></p>
                    <h1 class="mb-0 bread">MyPage</h1>
                </div>
            </div>
        </div>
    </section>

    <section class="ftco-section ">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-6 text-center mb-5">
                    <h2 class="heading-section" th:text="${member.name} + ' 회원님'"></h2>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-10">
                    <div class="wrapper">
                        <!-- 버튼 추가 영역 -->
                        <nav class="my-nav">
                            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                <button class="nav-link active" onclick="showSection('editProfileSection')">프로필</button>
                                <button class="nav-link active" onclick="showSection('petProfileSection')">펫 프로필</button>
                                <button class="nav-link active" onclick="showSection('petsitterRegist')">펫시터 자격신청</button>
                                <button class="nav-link active" onclick="showSection('Iwilltakecareofyou')">돌봐드려요</button>
                                <button class="nav-link active" onclick="showSection('Pleasetakecare')">돌봐주세요</button>
                            </div>
                        </nav>

                        <!-- 원본 -->
<!--                        <div class="row justify-content-center">-->
<!--                            <div class="col-auto mb-3">-->
<!--                                <button class="btn btn-success btn-lg px-4" onclick="showSection('editProfileSection')">회원정보 수정</button>-->
<!--                            </div>-->
<!--                            <div class="col-auto mb-3">-->
<!--                                <button class="btn btn-success btn-lg px-4" onclick="showSection('petProfileSection')">펫 프로필</button>-->
<!--                            </div>-->
<!--                            <div class="col-auto mb-3">-->
<!--                                <button class="btn btn-success btn-lg px-4" onclick="showSection('petsitterRegist')">펫시터 자격신청</button>-->
<!--                            </div>-->
<!--                            <div class="col">&ndash;&gt;-->
<!--                                <a th:href="@{/mypage/petsitterRegist}" class="btn btn-primary" role="button">펫시터 자격신청</a>-->
<!--                            </div>-->
<!--                            <div class="col-auto mb-3">-->
<!--                                <button class="btn btn-success btn-lg px-4" onclick="showSection('Iwilltakecareofyou')">돌봐드려요</button>-->
<!--                            </div>-->
<!--                            <div class="col-auto mb-3">-->
<!--                                <button class="btn btn-success btn-lg px-4" onclick="showSection('Pleasetakecare')">돌봐주세요</button>-->
<!--                            </div>-->
<!--                            <div class="col">-->
<!--                                <button class="btn btn-primary" onclick="showSection('payStatusSection')">결제 내역</button>-->
<!--                            </div>-->
<!--                        </div>-->
                        <!-- 버튼 추가 영역 끝 -->

                        <!-- 섹션 추가 영역 -->
                        <!--회원정보수정-->
                        <div id="editProfileSection" style="display:none;">
                            <h3 class="my-section-title"></h3>
                            <form id="profileUpdateForm" method="post">
                                <!-- 사용자에게 보이지 않는 ID를 저장하는 숨겨진 필드 -->
                                <input type="hidden" name="id" th:value="${member.id}">
                                <div class="form-group">
                                    <label for="profileName">이름:</label>
                                    <input type="text" class="form-control" name="name" th:value="${member.name}"
                                           id="profileName"
                                           readonly>
                                </div>
                                <div class="form-group">
                                    <label for="profileAddress">주소:</label>
                                    <input type="text" class="form-control" name="address" th:value="${member.address}"
                                           id="profileAddress"
                                           required>
                                </div>
                                <div class="form-group">
                                    <label for="profilePhone">연락처:</label>
                                    <input type="text" class="form-control" name="phone" th:value="${member.phone}"
                                           id="profilePhone"
                                           required>
                                </div>
                                <div class="form-group">
                                    <label for="profileNickName">닉네임:</label>
                                    <input type="text" class="form-control" name="nickName" id="profileNickName"
                                           th:value="${member.nickName}" required>
                                </div>
                                <div class="form-group">
                                    <label for="profileBirth">생일:</label>
                                    <input type="text" class="form-control" name="Birth" id="profileBirth"
                                           th:value="${member.birth}" readonly>
                                </div>
                                <br>
                                <button type="submit" class="btn btn-primary btn-lg"
                                        style="background-color: #28a745; border: none; color: white; padding: 10px 20px; font-size: 16px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease;">수정하기
                                </button>
                            </form>
                        </div>

                        <!--펫프로필-->
                        <div id="petProfileSection" style="display:none;">
<!--                            <h3 class="my-section-title">펫 프로필</h3>-->
                            <div>
                                <h4>등록된 펫</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th scope="col">번호</th>
                                        <th scope="col">이름</th>
                                        <th scope="col">성별</th>
                                        <th scope="col">품종</th>
                                        <th scope="col">생일</th>
                                    </tr>
                                    </thead>
                                    <tbody id="petTableBody">
                                    <!--                                    <tr>-->
                                    <!--                                        <th scope="row">1</th>-->
                                    <!--                                        <td>절망이</td>-->
                                    <!--                                        <td>남자아이</td>-->
                                    <!--                                        <td>푸들</td>-->
                                    <!--                                        <td>10</td>-->
                                    <!--                                    </tr>-->
                                    <!-- 여기서 AJAX로 데이터를 받아와서 추가할 것입니다. -->
                                    </tbody>
                                </table>
                                <a th:href="@{/pet/registPet}">
                                    <button class="btn btn-primary btn-lg"
                                            style="background-color: #28a745; border: none; color: white; padding: 10px 20px; font-size: 16px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease;">
                                        추가 등록하기
                                    </button>
                                </a>

                            </div>
                        </div>

                        <script>
                            $(document).ready(function () {
                                // 페이지가 로드되면 서버에서 펫 정보를 가져옴
                                $.ajax({
                                    url: "/mypage/mypage/petDetails",
                                    method: "GET",
                                    dataType: "json",
                                    success: function (data) {
                                        let tbody = $('#petTableBody');
                                        tbody.empty(); // 기존 테이블 비우기

                                        $.each(data, function (index, pet) {
                                            let row = `<tr>
                            <th scope="row">${index + 1}</th>
                            <td>${pet.name}</td>
                            <td>${pet.petGender}</td>
                            <td>${pet.breed}</td>
                            <td>${pet.birth}</td>
                        </tr>`;
                                            tbody.append(row); // 테이블에 행 추가
                                        });
                                    },
                                    error: function (error) {
                                        console.log("데이터 가져오기 실패", error);
                                    }
                                });
                            });
                        </script>

                        <!-- 펫시터 자격신청 -->
                        <div id="petsitterRegist" style="display:none;">
<!--                            <h3 class="my-section-title">펫시터 자격 신청</h3>-->
                            <!-- form 태그에 action과 method 속성 추가 -->
                            <form th:action="@{/mypage/petsitterRegist}" method="post">
                                <div class="form-group">
                                    <label for="name">이름:</label>
                                    <input type="text" class="form-control" id="name" name="name" placeholder="이름을 입력하세요">
                                </div>
                                <div class="form-group">
                                    <label for="birthday">생년월일:</label>
                                    <input type="date" class="form-control" id="birthday" name="birth" placeholder="생년월일을 입력하세요">
                                </div>
                                <div class="form-group">
                                    <label for="ssn">주민등록번호 (형식: 123456-7):</label>
                                    <input type="text" class="form-control" id="ssn" name="personalIdentificationNum" placeholder="주민등록번호를 입력하세요 (형식: 123456-7)" maxlength="8">
                                </div>
                                <div class="form-group">
                                    <label for="phone">연락처 (형식: 010-1234-5678):</label>
                                    <input type="text" class="form-control" id="phone" name="phone" placeholder="연락처를 입력하세요">
                                </div>
                                <div class="form-group">
                                    <label for="smoking">흡연 여부:</label>
                                    <select class="form-control" id="smoking" name="smokingStatus">
                                        <option value="예">예</option>
                                        <option value="아니오">아니오</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="address">거주지 주소:</label>
                                    <input type="text" class="form-control" id="address" name="address" placeholder="거주지 주소를 입력하세요">
                                </div>
                                <div class="form-group">
                                    <label for="currentJob">현재 하는 일:</label>
                                    <input type="text" class="form-control" id="currentJob" name="job" placeholder="현재 하는 일을 입력하세요">
                                </div>
                                <div class="form-group">
                                    <label for="petExperience">반려 경험 유무:</label>
                                    <select class="form-control" id="petExperience" name="petOwnershipExp">
                                        <option value="예">예</option>
                                        <option value="아니오">아니오</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="certification">자격증:</label>
                                    <input type="text" class="form-control" id="certification" name="certification" placeholder="자격증을 입력하세요">
                                </div>
                                <!-- 지원동기 추가 -->
                                <div class="form-group">
                                    <label for="motivation">지원동기:</label>
                                    <textarea class="form-control" id="motivation" name="motivationForApplying" placeholder="지원동기를 입력하세요" rows="4"></textarea>
                                </div>
                                <br>
                                <button type="submit" class="btn btn-primary">등록하기</button>
                            </form>
                        </div>

                        <!--이용 내역 세션  돌봐드려요-->
                        <div id="Iwilltakecareofyou" style="display:none;">

                            <!-- 현재 진행중인 내역 -->
                            <div>
                                <h4>현재 요청한 내역</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th>신청 정보</th>
                                        <th scope="col">펫시터</th>
                                        <th scope="col">서비스 날짜</th>
                                        <th scope="col">예약 신청 날짜</th>
                                        <th scope="col">크기, 마리</th>
                                        <th scope="col">시작, 종료</th>
                                        <th>예약변경</th>
                                        <th>예약상태</th>
                                        <th>결제 상태</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="reservationDto ,stat :${reservationDtoList}"
                                        th:object="${reservationDto}">
                                        <form id="reservationForm" method="post" th:object="${reservationDtoList}">
                                            <label>
                                                <input type="hidden" th:value="${reservationDto.partnerOrderId}"
                                                       name="partnerOrderId">
                                            </label>

                                            <td>
                                                <a th:href="@{|/petsitter/reservationdetail/${reservationDto.partnerOrderId}|}"
                                                   onclick="window.open(this.href, '_blank', 'left=2000%,top=800%, width=900, height=700'); return false;">자세히</a>
                                            </td>
                                            <td> <a th:href="@{|/petsitter/detail/${reservationDto.petSitterId}|}" th:text="${reservationDto.petSitterId}"></a></td>
                                            <td th:text="${reservationDto.reservationDay}"></td>
                                            <td th:text="${#temporals.format(reservationDto.createdAt, 'yyyy-MM-dd/a hh:mm')}"></td>

                                            <td th:object="${reservationDto.petSizeAndHowManyPets}">
                                                <div th:if="${#lists.size(reservationDto.petSizeAndHowManyPets) >= 2}">
                                                    <span th:text="${reservationDto.petSizeAndHowManyPets[0].petSize}"
                                                          name="petSize"></span>
                                                    <span th:text="${reservationDto.petSizeAndHowManyPets[0].howManyPet}"></span>
                                                    <span th:text="'외...'"></span>
                                                </div>
                                                <div th:if="${#lists.size(reservationDto.petSizeAndHowManyPets) <2}">
                                                    <span th:text="${reservationDto.petSizeAndHowManyPets[0].petSize}"
                                                          name="petSize"></span>
                                                    <span th:text="${reservationDto.petSizeAndHowManyPets[0].howManyPet}"></span>
                                                </div>
                                            </td>

                                            <td>
                                                <span th:text="${reservationDto.startTime}" name="startTime"></span>
                                                <span th:text="${reservationDto.endTime}" name="endTime"></span>
                                            </td>
                                            <td>
                                                <div>
                                                    <!--상태변경-->
                                                    <button type="submit"
                                                            th:formaction="@{/petsitter/memberReservationCancel}"
                                                            th:if="${reservationDto.reservationStatus.getReservationStatus()} == 'ready'"
                                                            th:text="예약취소" value="cancel" class="btn btn-danger"
                                                            name="sittingStatus"></button>
                                                </div>
                                            </td>
                                            <td>
                                                <!--상태-->
                                                <span th:if="${reservationDto.reservationStatus.getReservationStatus()} == 'ready'"
                                                      th:text="예약대기"></span>
                                                <!--                                                <span th:if="${reservationDto.reservationStatus.getReservationStatus()} == 'OK'"-->
                                                <!--                                                      th:text="예약승인"></span>-->
                                                <span th:if="${reservationDto.reservationStatus.getReservationStatus()} == 'cancel'"
                                                      th:text="예약취소" class=""></span>
                                            </td>
                                            <td>
                                                <span th:if="${reservationDto.payStatus}">결제 완료</span>
                                                <span th:if="${!reservationDto.payStatus}">환불 완료</span>
                                            </td>
                                        </form>
                                    </tr>

                                    <!-- 다른 진행중인 내역 추가 -->
                                    </tbody>
                                </table>
                            </div>

                            <div id="sitting">
                                <h4>진행중인 돌봄</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th>신청 정보</th>
                                        <th scope="col">펫시터</th>
                                        <th scope="col">서비스 날짜</th>
                                        <th scope="col">견종, 마리</th>
                                        <th scope="col">시작, 종료</th>
                                        <th scope="col">완료 승인</th>
                                        <th>돌봄상태</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                        <tr th:each="sittingDto ,stat :${sittingDtoList}" th:object="${sittingDto}">
                                            <form method="post">
                                            <label>
                                                <input type="hidden" th:value="${sittingDto.partnerOrderId}"
                                                       name="partnerOrderId">
                                            </label>

                                            <td>
                                                <a th:href="@{|/petsitter/reservationdetail/${sittingDto.partnerOrderId}|}"
                                                   onclick="window.open(this.href, '_blank', 'left=2000%,top=800%, width=900, height=700'); return false;">자세히</a>
                                            </td>

                                            <td> <a th:href="@{|/petsitter/detail/${sittingDto.petSitterId}|}" th:text="${sittingDto.petSitterId}"></a></td>
                                            <td th:text="${sittingDto.serviceDate}"></td>

                                            <td th:object="${sittingDto.petSizeAndHowManyPets}">
                                                <div th:if="${#lists.size(sittingDto.petSizeAndHowManyPets) >= 2}">
                                                    <span th:text="${sittingDto.petSizeAndHowManyPets[0].petSize}"
                                                          name="petSize"></span>
                                                    <span th:text="${sittingDto.petSizeAndHowManyPets[0].howManyPet}"></span>
                                                    <span th:text="'외...'"></span>
                                                </div>
                                                <div th:if="${#lists.size(sittingDto.petSizeAndHowManyPets) <2}">
                                                    <span th:text="${sittingDto.petSizeAndHowManyPets[0].petSize}"
                                                          name="petSize"></span>
                                                    <span th:text="${sittingDto.petSizeAndHowManyPets[0].howManyPet}"></span>
                                                </div>
                                            </td>

                                            <td>
                                                <span th:text="${sittingDto.startTime}" name="startTime"></span>
                                                <span th:text="${sittingDto.endTime}" name="endTime"></span>
                                            </td>
                                            <td>
                                                <button type="submit"
                                                        th:formaction="@{/petsitter/membersitting}"
                                                        class="btn btn-primary"
                                                        th:if="${sittingDto.sittingStatus.getSittingStatus()} == 'WAITING_MEMBER_CHECK'"
                                                        th:text="'돌봄 완료 승인'" id="completeButton" value="MEMBER_CHECK"
                                                        name="sittingStatus"></button>
                                            </td>
                                            <td th:if="${sittingDto.sittingStatus.getSittingStatus()}=='StandbySitting'"
                                                th:text="'돌봄 대기 중'"></td>
                                            <td th:if="${sittingDto.sittingStatus.getSittingStatus()}=='START_SITTING'"
                                                th:text="'돌봄 중'"></td>
                                            <td th:if="${sittingDto.sittingStatus.getSittingStatus()}=='WAITING_MEMBER_CHECK'"
                                                th:text="'완료 승인 대기중'"></td>

                                            </form>
                                        </tr>

                                    <!-- 다른 진행중인 내역 추가 -->
                                    </tbody>
                                </table>
                            </div>

                            <!--이용 내역 세션  돌봐드립니다-->
                            <div>
                                <h4>완료된 내역</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th>신청 정보</th>
                                        <th scope="col">펫시터</th>
                                        <th scope="col">서비스 날짜</th>
                                        <th>견종, 마리</th>
                                        <th>상태</th>
                                        <th>리뷰</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr th:each="completeSittingDto ,stat :${completeSittingDtoList}">
                                        <form id="completeForm" method="post">
                                            <label>
                                                <input type="hidden" th:value="${completeSittingDto.partnerOrderId}"
                                                       name="partnerOrderId">
                                            </label>
                                            <td>
                                                <a th:href="@{|/petsitter/sittingdetail/${completeSittingDto.partnerOrderId}|}"
                                                   onclick="window.open(this.href, '_blank', 'left=2000%,top=800%, width=800, height=600'); return false;">자세히</a>
                                            </td>
                                            <td> <a th:href="@{|/petsitter/detail/${completeSittingDto.petSitterId}|}" th:text="${completeSittingDto.petSitterId}"></a></td>
                                            <td th:text="${completeSittingDto.serviceDate}"></td>

                                            <td th:object="${completeSittingDto.petSizeAndHowManyPets}">
                                                <div th:if="${#lists.size(completeSittingDto.petSizeAndHowManyPets) >= 2}">
                                                    <span th:text="${completeSittingDto.petSizeAndHowManyPets[0].petSize}"
                                                          name="petSize"></span>
                                                    <span th:text="${completeSittingDto.petSizeAndHowManyPets[0].howManyPet}"></span>
                                                    <span th:text="'외...'"></span>
                                                </div>
                                                <div th:if="${#lists.size(completeSittingDto.petSizeAndHowManyPets) < 2}">
                                                    <span th:text="${completeSittingDto.petSizeAndHowManyPets[0].petSize}"
                                                          name="petSize"></span>
                                                    <span th:text="${completeSittingDto.petSizeAndHowManyPets[0].howManyPet}"></span>
                                                </div>
                                            </td>

                                            <td>
                                                <input type="hidden" name="serviceDate"
                                                       th:value="${completeSittingDto.serviceDate}">
                                                <input type="hidden" name="petSitterId"
                                                       th:value="${completeSittingDto.petSitterId}">
                                                <input type="hidden" name="note" th:value="${completeSittingDto.note}">
                                                <input type="hidden" name="startTime"
                                                       th:value="${completeSittingDto.startTime}">
                                                <input type="hidden" name="endTime"
                                                       th:value="${completeSittingDto.endTime}">
                                                <input type="hidden" name="createdAt"
                                                       th:value="${completeSittingDto.createdAt}">
                                                <span th:if="${completeSittingDto.sittingStatus.getSittingStatus()} == 'MEMBER_CHECK'"
                                                      th:text="'돌봄 완료'"></span>
                                            </td>
                                            <td>
                                                <a th:href="@{|/petsitter/review/${completeSittingDto.partnerOrderId}|}"
                                                   th:if="${completeSittingDto.sittingStatus.getSittingStatus()} == 'MEMBER_CHECK'
                                                            and ${!completeSittingDto.reviewCheck}"
                                                   onclick="window.open(this.href, '_blank', 'left=2000%,top=800%, width=900, height=700'); return false;">리뷰
                                                    등록</a>


                                                <span th:if="${completeSittingDto.sittingStatus.getSittingStatus()} == 'MEMBER_CHECK'
                                                            and ${completeSittingDto.reviewCheck}">등록완료</span>

                                                <!--                                                돌봄 완료 and 이 주문 건에 대해서 리뷰를 작성을 했는지 체크-->

                                            </td>
                                        </form>
                                    </tr>

                                    <!-- 다른 진행중인 내역 추가 -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!--이용 내역 세션  돌봐주세요-->
                        <div id="Pleasetakecare" style="display:none;">

                            <!-- 현재 진행중인 내역 -->
                            <div id="careDto">
                                <h4>현재 요청받은 내역</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th scope="col">펫시터</th>
                                        <th scope="col">펫시터 한줄 소개</th>
<!--                                        <th scope="col">예약 번호</th>-->
                                        <th scope="col">서비스 날짜</th>
<!--                                        <th scope="col">예약 신청 날짜</th>-->
                                        <th scope="col">댕댕이 이름</th>
                                        <th>예약수락</th>
                                        <th>예약거절</th>
                                        <th scope="col">예약 상태</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr th:each="pleaseCareDto ,stat :${pleaseCare}"
                                        th:if="${pleaseCareDto.status.getReservationStatus() eq 'PENDING' || pleaseCareDto.status.getReservationStatus == 'REQUEST_ACCEPTED'}"
                                        th:object="${pleaseCareDto}">
                                        <form id="reservationByPetsitter" method="post" th:object="${pleaseCareDto}">
                                            <label>
                                                <input type="hidden" th:value="${pleaseCareDto.memberId}">
                                            </label>

                                            <td>
                                                <a th:href="@{|/petsitter/detail/${pleaseCareDto.petSitterId}|}" th:text="${pleaseCareDto.petSitterId}"></a>
                                            </td>
<!--                                            <td th:text="${pleaseCareDto.petSitterId}"></td>-->
<!--                                            <td th:text="${pleaseCareDto.reservationId}"></td>-->
                                            <td th:text="${pleaseCareDto.introduce}"></td>

                                            <td>
                                                <span th:text="${pleaseCareDto.startDate}" name="startTime"></span>
                                                <span th:text="${pleaseCareDto.endDate}" name="endTime"></span>
                                            </td>
<!--                                            <td th:text="${pleaseCareDto.createdDate}"></td>-->
                                            <td th:text="${pleaseCareDto.petName}"></td>

                                            <form method="post" onsubmit="return confirm('정말 돌봄 요청을 수락하시겠습니까?')">
                                                <label>
                                                    <input type="hidden" name="reservationId"
                                                           th:value="${pleaseCareDto.reservationId}">
                                                </label>
                                                <td>
                                                    <button th:if="${pleaseCareDto.status.getReservationStatus} == 'PENDING'"
                                                            th:formaction="@{/mypage/acceptRequest}"
                                                            class="btn btn-sm btn-primary" type="submit">수락
                                                    </button>
                                                </td>
                                            </form>

                                            <form method="post" onsubmit="return confirm('정말 돌봄 요청을 거절하시겠습니까?')">
                                                <label>
                                                    <input type="hidden" name="reservationId"
                                                           th:value="${pleaseCareDto.reservationId}">
                                                </label>
                                                <td>
                                                    <button th:if="${pleaseCareDto.status.getReservationStatus} == 'PENDING'"
                                                            th:formaction="@{/mypage/deleteReservation}"
                                                            class="btn btn-sm btn-danger" type="submit">거절
                                                    </button>
                                                </td>
                                            </form>


                                            <div>
                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'PENDING'}"
                                                th:text='예약대기'></td>
                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'REQUEST_REJECTED'}"
                                                th:text="예약거절"></td>
                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'REQUEST_ACCEPTED'}"
                                                th:text="예약수락"></td>
                                            </div>
                                        </form>
                                    </tr>

                                    <!-- 다른 진행중인 내역 추가 -->
                                    </tbody>
                                </table>
                            </div>

                            <div id="sittingForm">
                                <h4>진행중인 돌봄</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th scope="col">펫시터</th>
                                        <th scope="col">예약 번호</th>
                                        <th scope="col">서비스 날짜</th>
                                        <th scope="col">댕댕이 이름</th>
                                        <th>완료 승인</th>
                                        <th scope="col">돌봄 상태</th>

                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr th:each="pleaseCareDto ,stat :${pleaseCare}"
                                        th:object="${pleaseCareDto}"
                                        th:if="${pleaseCareDto.status.getReservationStatus() eq 'IN_CARE' || pleaseCareDto.status.getReservationStatus()  eq 'CARE_COMPLETION_REQUEST'}"
                                    >

                                        <div id="inCare" method="post" th:object="${pleaseCareDto}">
                                            <label>
                                                <input type="hidden" th:value="${pleaseCareDto.memberId}">
                                            </label>

                                            <td>
                                                <a th:href="@{|/petsitter/detail/${pleaseCareDto.petSitterId}|}" th:text="${pleaseCareDto.petSitterId}"></a>
                                            </td>
                                            <td th:text="${pleaseCareDto.reservationId}"></td>
                                            <td>
                                                <span th:text="${pleaseCareDto.startDate}" name="startTime"></span> ~
                                                <span th:text="${pleaseCareDto.endDate}" name="endTime"></span>
                                            </td>
                                            <td th:text="${pleaseCareDto.petName}"></td>
                                            <form method="post" onsubmit="return confirm('정말 돌봄완료 상태로 바꾸시겠습니까?')">
                                                <td>
                                                    <label>
                                                        <input type="hidden" name="reservationId"
                                                               th:value="${pleaseCareDto.reservationId}">
                                                    </label>
                                                    <button th:if="${pleaseCareDto.status.getReservationStatus} == 'CARE_COMPLETION_REQUEST'"
                                                            th:formaction="@{/mypage/completeReservation}"
                                                            class="btn btn-sm btn-primary" type="submit"
                                                    >돌봄완료

                                                    </button>

                                                </td>

                                            </form>

                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'IN_CARE'}"
                                                th:text="돌봄중"></td>
                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETION_REQUEST'}"
                                                th:text="돌봄완료요청"></td>



                                        </div>
                                    </tr>
                                    <!-- 다른 진행중인 내역 추가 -->
                                    </tbody>
                                </table>
                            </div>

                            <!--이용 내역 세션  돌봐드립니다-->
                            <div id="completedUsageSection">
                                <h4>완료된 내역</h4>
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th scope="col">펫시터</th>
                                        <th scope="col">서비스 날짜</th>
                                        <th scope="col">댕댕이 이름</th>
                                        <th scope="col">상태</th>
                                        <th scope="col">리뷰</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="pleaseCareDto ,stat :${pleaseCare}"
                                        th:object="${pleaseCareDto}"
                                        th:if="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE' ||
                                                 pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE_REVIEW_AVAILABLE'}">

                                        <form id="completeCare" method="post" th:object="${pleaseCareDto}">
                                            <label>
                                                <input type="hidden" th:value="${pleaseCareDto.memberId}">
                                            </label>

                                            <td>
                                                <a th:href="@{|/petsitter/detail/${pleaseCareDto.petSitterId}|}" th:text="${pleaseCareDto.petSitterId}"></a>
                                            </td>
                                            <td>
                                                <span th:text="${pleaseCareDto.startDate}" name="startTime"></span>
                                                <span th:text="${pleaseCareDto.endDate}" name="endTime"></span>
                                            </td>
                                            <td th:text="${pleaseCareDto.petName}"></td>

                                            <div>
                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE'}"
                                                th:text="돌봄완료">
                                            <td th:if="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE_REVIEW_AVAILABLE'}"
                                                th:text="돌봄완료"></td>
                                            </div>

                                                <div>
                                                    <td>
                                                        <div>
                                                            <span th:if="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE'}" th:text="'돌봄완료'"></span>
                                                            <span th:if="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE_REVIEW_AVAILABLE'}">
            <a th:href="@{|/petsitterfinder/review/${pleaseCareDto.reservationId}|}"
               onclick="window.open(this.href, '_blank', 'left=2000%,top=800%, width=900, height=700'); return false">
                리뷰 작성
            </a>
        </span>
                                                            <span th:unless="${pleaseCareDto.status.getReservationStatus() eq 'CARE_COMPLETE_REVIEW_AVAILABLE'}" th:text="'리뷰 작성'"></span>
                                                        </div>
                                                    </td>
                                                </div>
                                        </form>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!--펫시터 정보수정-->


                        <!--결제내역-->
                        <div id="payStatusSection" style="display:none;">

                            <!-- 완료된 내역 -->

                            <table class="table">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th scope="col"> 펫시터</th>
                                    <th scope="col">결제 날짜/시간</th>
                                    <th scope="col">환불 날짜/시간</th>
                                    <th scope="col">결제 금액</th>
                                    <th scope="col">결제 상태</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="orderDto ,stat :${orderDtoList}"
                                    th:object="${orderDto}">
                                    <label>
                                        <input type="hidden" th:value="${orderDto.partnerOrderId}"
                                               name="partnerOrderId">
                                    </label>
                                    <td>
                                        <a th:href="@{|/petsitter/reservationdetail/${orderDto.partnerOrderId}|}"
                                           onclick="window.open(this.href, '_blank', 'left=2000%,top=800%, width=900, height=700'); return false;">자세히</a>
                                    </td>
                                    <td>
                                        <a th:href="@{|/petsitter/detail/${orderDto.petSitterId}|}"
                                           th:text="${orderDto.petSitterId}"></a>
                                    </td>
                                    <td><span th:text="${#temporals.format(orderDto.payDate, 'yyyy-MM-dd/a hh:mm')}"
                                              name="createdAt"></span>
                                    <td>
                                        <span th:if="${!orderDto.payStatus}"
                                              th:text="${#temporals.format(orderDto.payCancelDate, 'yyyy-MM-dd/a hh:mm')}"></span>
                                    </td>
                                    <td th:text="${orderDto.totalPrice}"></td>
                                    <td>
                                              <span th:if="${orderDto.payStatus}"
                                                    th:text="'결제완료'"></span>
                                        <span th:unless="${orderDto.payStatus}"
                                              th:text="'환불완료'"></span>
                                    </td>
                                </tr>
                                <!-- 다른 진행중인 내역 추가 -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </section>
    <script>
        const message = '[[${message}]]';
        message && alert(message);
    </script>


    <!-- loader -->
    <div id="ftco-loader" class="show fullscreen">
        <svg class="circular" width="48px" height="48px">
            <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/>
            <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                    stroke="#F96D00"/>
        </svg>
    </div>
    <script>
        const message = '[[${message}]]';
        message && alert(message);
    </script>
</div>
</body>
</html>
